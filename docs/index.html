<!DOCTYPE html>
<html>
    <head>
        <style>
        html, body {
            width: 100%;
            height: 100%;
            margin: 0px;
            border: 0;
            overflow: hidden; /*  Disable scrollbars */
            display: block;  /* No floating content on sides */
        }
        </style>
    </head>
    <body>
        
        <button id="play">Start</button>
        <br>
        <input type = "range" min = '0' max = '22050' id = 'lowpass_slider'>Lowpass Slider</input>
    </body>
</html>

<script>
    const button = document.getElementById("play");
    button.onclick =  function() {
        const pluckLength = .1;
        var audioCtx = new AudioContext();
        var pluckBuffer = new AudioBuffer({numberOfChannels: 1, length: audioCtx.sampleRate * pluckLength, sampleRate: audioCtx.sampleRate});
        var buffer = pluckBuffer.getChannelData(0);
        for(var i = 0; i < buffer.length; i++) {
            buffer[i] = Math.random() * 2 - 1; // generate white noise sample
            // buffer[i] = 1;
        }
        
        var pluckSource = new AudioBufferSourceNode(audioCtx, {buffer: pluckBuffer}); // creates a source to play the pluck buffer from 

        var delay = new DelayNode(audioCtx, {delayTime: pluckLength});
        var lowpass_slider = document.getElementById('lowpass_slider');
        var filter = new BiquadFilterNode(audioCtx, {type: 'lowpass', frequency: lowpass_slider.value});
        var merge = new ChannelMergerNode(audioCtx, {numberOfInputs: 2});
        var split = new ChannelSplitterNode(audioCtx, {numberOfOutputs: 2});

        pluckSource.connect(merge);
        merge.connect(delay);
        delay.connect(filter);
        filter.connect(merge);
        merge.connect(split);
        split.connect(audioCtx.destination);
        pluckSource.start();
       
    }
    
</script>